(function(){function d(){document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges()}function f(){$.getScript("https://unpkg.com/diff-dom@latest/diffDOM.js").then(()=>{window.diffDOM&&(A=new diffDOM({textDiff:function(N,O,P,Q){return N.data=O===P?Q:Q,!0},valueDiffing:!1}))}),window.AVIARY_API_KEY&&$.getScript("/cms/aviary-editor.js").then(()=>{window.Aviary&&(window.csdkImageEditor=new Aviary.Feather({apiKey:window.AVIARY_API_KEY,onSave:function(N,O){g(),x?x.css("background-image",x.css("background-image").replace(/url\(.+\)/i,"url("+O+")")):E.src=O,csdkImageEditor.close(),h()},onError:console.log}),setTimeout(g,500))}),$.getScript("https://cdnjs.cloudflare.com/ajax/libs/dragula/3.6.6/dragula.min.js").then(()=>{window.dragula&&$("ul, ol, .row").each(function(){B=dragula([$(this)[0]],{revertOnSpill:!0}).on("drag",function(){g()}).on("drop",function(){h()})})}),G=!0}function g(){v&&v.html("").hide(),document.body&&(D=document.body.cloneNode(!0))}function h(){var N=A.diff(D,document.body);N&&N.length&&(K.push({ts:+new Date,diff:N}),clearInterval(F),L=[],g())}function j(){if(K.length){var N=K.pop();try{A.undo(document.body,N.diff)}catch(O){}L.push(N),g()}}function l(){if(L.length){var N=L.pop();try{A.undo(document.body,N.diff)}catch(O){}K.push(N),g()}}function m(){$("#yetiChangeIconMenu, #yetiUnderlay").hide(),g()}function n(){t.append("<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/dragula/3.7.2/dragula.min.css\">"),t.append("<link rel=\"stylesheet\" href=\"https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css\">"),t.append("<link rel=\"stylesheet\" href=\"https://cdn.linearicons.com/free/1.0.0/icon-font.min.css\">"),t.append("<link rel=\"stylesheet\" href=\"https://fonts.googleapis.com/css?family=Lato:400,300,700\">"),u.append("<div id=\"yetiUnderlay\"></div><div id=\"yetiChangeIconMenu\"><h2><span class=\"close\">x</span>Change Icon</h2></div>"),$("#yetiUnderlay, #yetiChangeIconMenu .close").on("mousedown",m),u.append("<img id=\"bgImageContainer\" style=\"display:none\">"),t.append("<link rel=\"stylesheet\" href=\"/cms/yeti.css\">"),r(),window.UPLOADCARE_PUBLIC_KEY&&$.getScript("https://ucarecdn.com/libs/widget/3.1.2/uploadcare.full.min.js").then(()=>{u.append("<input type=\"hidden\" role=\"uploadcare-uploader\" name=\"content\" data-images-only />"),y=uploadcare.Widget("[role=uploadcare-uploader]"),y.onUploadComplete(function(N){g(),x?x.css("background-image",x.css("background-image").replace(/url\(.+\)/i,"url("+N.cdnUrl+")")):E.src=N.cdnUrl,h()}),setTimeout(()=>{$(".uploadcare--widget__button.uploadcare--widget__button_type_open, .uploadcare--widget.uploadcare--widget_status_ready").css("opacity","0 !important").css("position","absolute !important").css("display","none !important").hide(),g()},500),g()}),window.AVIARY_API_KEY&&$("img").each(function(N){$(this).attr("id")||$(this).attr("id","img-"+N++)}),H=!0,g()}function o(){$(document).ready(()=>{H||n(),v=$(".yeti-context-menu.main"),w=$(".yeti-context-menu.secondary"),t.append("<style id=\"yetiOutline\">*:hover { box-shadow: inset 0 0 2px rgba(255,100,150,0.95); } #avpw_holder * {box-shadow: none !important;} ul, ol, .row { cursor: move; } </style>"),$("[contenteditable]").on("focusin",g).on("focusout",h),C=!0,$("body :not(script) :not(style) :not(iframe)").contents().filter(function(){return 3===this.nodeType&&$(this).text().trim()&&!$(this).closest("#avpw_holder").length}).parent().attr("contenteditable",!0).off("click").on("click",function(N){N.preventDefault(),N.stopPropagation()}),u.on("contextmenu","*",function(N){N.preventDefault(),J.forEach(Q=>{"function"==typeof Q&&Q(this)});var O=N.clientX,P=N.clientY;O>$(window).width()-160&&(O=parseInt($(window).width()-160)),P>$(window).height()-160&&(P=parseInt($(window).height()-v.height())),v.css({top:P+"px",left:O+"px"}).show()}),u.on("mousedown","*",N=>{1!==N.which||(v.html("").hide(),w.hide())}),(window.UPLOADCARE_PUBLIC_KEY||window.AVIARY_API_KEY)&&u.append("<div class=\"yeti cleanslate\"><div id=\"imageEditOverlay\"><i class=\"ion-edit\"></i><i class=\"ion-upload\"></i></div></div>"),window.UPLOADCARE_PUBLIC_KEY||$("#imageEditOverlay .ion-upload").remove(),window.AVIARY_API_KEY||$("#imageEditOverlay .ion-edit").remove(),(window.UPLOADCARE_PUBLIC_KEY||window.AVIARY_API_KEY)&&$("body").on("mouseenter","img",function(){$(this).closest("#avpw_holder").length||65>$(this).width()||(E=$(this)[0],$("#imageEditOverlay").show().css("left",$(this).offset().left+$(this).width()/2-40).css("top",$(this).offset().top+$(this).height()/2-14))}),window.AVIARY_API_KEY&&u.on("click","#imageEditOverlay i.ion-edit",()=>{g(),setTimeout(()=>{$("#imageEditOverlay").css("top","-200px").css("left","-200px")},500),x=null,csdkImageEditor.launch({image:E.id,url:E.src}),d(),setTimeout(()=>{w.hide(),g()},300)}),window.UPLOADCARE_PUBLIC_KEY&&u.on("click","#imageEditOverlay i.ion-upload",()=>{g(),x=null,y&&"function"==typeof y.openDialog&&(z=y.openDialog()),setTimeout(()=>{g()},300)}),u.on("selectstart","*",function(N){N.stopPropagation();var O=this;g(),$(document).on("mouseup",function(){try{var Q=window.getSelection(),R=Q.getRangeAt(0),S=R.getBoundingClientRect()}catch(T){}S&&Q&&Q.toString().length&&!v.html().length&&(w.html(""),w.prepend(()=>{return $("<a class=\"yeti-context-menu-button yeti-quarter-button\"><span class=\"lnr lnr-strikethrough\"></span></a>").on("mousedown",{that:O},()=>{g(),document.execCommand("strikeThrough",!1,null),h()})}),w.prepend(()=>{return $("<a class=\"yeti-context-menu-button yeti-quarter-button\"><span class=\"lnr lnr-underline\"></span></a>").on("mousedown",{that:O},()=>{g(),document.execCommand("underline",!1,null),h()})}),w.prepend(()=>{return $("<a class=\"yeti-context-menu-button yeti-quarter-button\"><span class=\"lnr lnr-italic\"></span></a>").on("mousedown",{that:O},()=>{g(),document.execCommand("italic",!1,null),h()})}),w.prepend(()=>{return $("<a class=\"yeti-context-menu-button yeti-quarter-button\"><span class=\"lnr lnr-bold\"></span></a>").on("mousedown",{that:O},()=>{g(),document.execCommand("bold",!1,null),h()})}),w.show().css("left",S.left+S.width/2-w.width()/2).css("top",S.top-36).show(),g())})}),u.on("mousedown","*",function(N){if(1===N.which){var O;if($(this).attr("class")&&$(this).attr("class").split(/\s+/).forEach(Q=>{-1!==M.indexOf(Q)&&(O=!0)}),!!O){I=this,$("#yetiChangeIconMenu i").removeClass("selected"),$("#yetiChangeIconMenu, #yetiUnderlay").fadeIn("fast");var P=$(this).attr("class").slice(2).trim();$("#yetiChangeIconMenu i."+P).addClass("selected"),g()}}})})}function p(){$("[contenteditable]").off("click").off("focusin").off("focusout").attr("contenteditable",!1),u.off("contextmenu").off("selectstart").off("mousedown").off("mouseenter").off("click"),$("#imageEditOverlay").hide().css("top","-200px").css("left","-200px"),$("#yetiOutline").remove(),$(document).off("mouseup"),w.hide(),v.hide(),B.destroy(),C=0}function q(){for(var N of document.styleSheets)if(N&&N.rules)for(let O of N.rules){let P="";if(O&&O.style&&O.style.content&&(P=O.style.content),P&&"\""===P[0])try{P=JSON.parse(P)}catch(R){}let Q=parseInt(P.toUnicode().split("\\u").join(""),16);if(1e4<Q&&1==P.length&&-1!==O.selectorText.indexOf(":before")){let R=O.selectorText.match(/\.[\w\-]*/g);R&&1===R.length&&-1==R[0].slice(1).indexOf("small")&&-1==M.indexOf(R[0].slice(1))&&M.push(R[0].slice(1))}}return M}function r(){for(var N=q(),O=0;O<N.length;O++)$("#yetiChangeIconMenu").append(()=>{var P=N[O],Q="";if(P&&""!==P.trim())return 0===P.indexOf("fa-")&&(Q="fa "),0===P.indexOf("icon-")&&(Q="icon "),0===P.indexOf("glyphicon-")&&(Q="glyphicon "),$(`<i class="${Q+N[O]}"></i>`).off("mousedown").on("mousedown",function(){var R=$(this).attr("class");$("#yetiChangeIconMenu i").removeClass("selected"),$(this).addClass("selected"),g(),s(R),setTimeout(m,50)})}),g()}function s(N){if(I){var O=$(I).attr("class").split(/\s+/).filter(P=>{return-1===M.indexOf(P)}).join(" ")+" "+N;$(I).attr("class",O),h()}}var t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J=[],K=[],L=[],M=[];String.prototype.toUnicode=function(){for(var N="",O=0;O<this.length;O++)N+="\\u"+("000"+this[O].charCodeAt(0).toString(16)).substr(-4);return N},function(N){N.save=function(O,P){if(O){"object"==typeof O&&(O=JSON.stringify(O,void 0,4)),P||(P="console.json");var Q=new Blob([O],{type:"text/json"}),R=document.createEvent("MouseEvents"),S=document.createElement("a");S.download=P,S.href=window.URL.createObjectURL(Q),S.dataset.downloadurl=["text/json",S.download,S.href].join(":"),R.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),S.dispatchEvent(R)}}}(console),J.push(function(){w.html("").css("top","-100px").css("left","-100px")}),J.push(function(N){!$(N).is("[contenteditable]")||$(N).is("a")||v.prepend(()=>{return $(".yeti-context-menu-button.create-link, .yeti-context-menu-button.remove-link").length?void 0:$("<a class=\"yeti-context-menu-button create-link\"><i class=\"ion-link\" style=\"padding-right:7px !important\"></i>Create Link</a>").on("mousedown",{that:N},()=>{g();var P=prompt("Please specify the link URL","https://");P&&document.execCommand("createLink",!1,P),h()})})}),J.push(function(N){$(N).is("a")&&v.prepend(()=>{return $(".yeti-context-menu-button.remove-link").length?void 0:$("<a class=\"yeti-context-menu-button remove-link\"><i class=\"ion-link\" style=\"padding-right:7px !important\"></i>Remove Link</a>").on("mousedown",{that:N},O=>{g(),$(O.data.that).after($("<span>"+$(O.data.that).html()+"</span>").attr("contenteditable",!0)).remove(),h()})})}),J.push(function(N){$(N).is("a")&&v.prepend(()=>{return $(".yeti-context-menu-button.create-link, .yeti-context-menu-button.edit-link").length?void 0:$("<a class=\"yeti-context-menu-button edit-link\"><i class=\"ion-link\" style=\"padding-right:7px !important\"></i>Edit Link</a>").on("mousedown",{that:N},O=>{g();var P=$(O.data.that).attr("href"),Q=prompt("Please specify the link URL",P);Q&&Q!==P&&$(O.data.that).attr("href",Q),h()})})}),J.push(function(N){$(N).is("[contenteditable]")&&v.prepend(()=>{return $(".yeti-context-menu-button .lnr-strikethrough").length?void 0:$("<a class=\"yeti-context-menu-button yeti-quarter-button\"><span class=\"lnr lnr-strikethrough\"></span></a>").on("mousedown",{that:N},()=>{g(),document.execCommand("strikeThrough",!1,null),h()})})}),J.push(function(N){$(N).is("[contenteditable]")&&v.prepend(()=>{return $(".yeti-context-menu-button .lnr-underline").length?void 0:$("<a class=\"yeti-context-menu-button yeti-quarter-button\"><span class=\"lnr lnr-underline\"></span></a>").on("mousedown",{that:N},()=>{g(),document.execCommand("underline",!1,null),h()})})}),J.push(function(N){$(N).is("[contenteditable]")&&v.prepend(()=>{return $(".yeti-context-menu-button .lnr-italic").length?void 0:$("<a class=\"yeti-context-menu-button yeti-quarter-button\"><span class=\"lnr lnr-italic\"></span></a>").on("mousedown",{that:N},()=>{g(),document.execCommand("italic",!1,null),h()})})}),J.push(function(N){$(N).is("[contenteditable]")&&v.prepend(()=>{return $(".yeti-context-menu-button .lnr-bold").length?void 0:$("<a class=\"yeti-context-menu-button yeti-quarter-button\"><span class=\"lnr lnr-bold\"></span></a>").on("mousedown",{that:N},()=>{g(),document.execCommand("bold",!1,null),h()})})}),J.push(function(N){var O;N&&$(N)&&$(N).attr("class")&&$(N).attr("class").split(/\s+/).forEach(P=>{-1!==M.indexOf(P)&&(O=!0)});!O||$(".icon-editor").length||v.prepend(()=>{return $(".yeti-context-menu-button .icon-editor").length?void 0:$("<a class=\"yeti-context-menu-button icon-editor\"><i class=\"ion-android-checkbox-outline-blank\" style=\"padding-right:7px !important\"></i>Choose Icon</a>").on("mousedown",{that:N},P=>{I=P.data.that,$("#yetiChangeIconMenu i").removeClass("selected"),$("#yetiChangeIconMenu, #yetiUnderlay").fadeIn("fast");var Q=$(P.data.that).attr("class").slice(2).trim();$("#yetiChangeIconMenu i."+Q).addClass("selected"),g()})})}),window.AVIARY_API_KEY&&J.push(function(N){v.append(()=>{if(!$(".yeti-context-menu-button.edit-image").length){var O=$(N).attr("src");return O&&"IMG"===N.tagName||(O=$(N).find("img").attr("src")),O?$("<a class=\"yeti-context-menu-button edit-image\"><i class=\"ion-images\"></i>Edit Image<img src=\""+O+"\"></a>").on("mousedown",{that:N},P=>{g(),E="IMG"==$(P.data.that)[0].tagName?$(P.data.that)[0]:$(P.data.that).find("img")[0],x=null,csdkImageEditor.launch({image:E.id,url:E.src}),d(),setTimeout(()=>{w.hide(),g()},300)}):void 0}})}),window.UPLOADCARE_PUBLIC_KEY&&J.push(function(N){v.append(()=>{if(!$(".yeti-context-menu-button.replace-image").length){var O=$(N).attr("src");return O&&"IMG"===N.tagName||(O=$(N).find("img").attr("src")),O?$("<a class=\"yeti-context-menu-button replace-image\"><i class=\"ion-images\"></i>Replace<img src=\""+O+"\"></a>").on("mousedown",{that:N},P=>{g(),E="IMG"==$(P.data.that)[0].tagName?$(P.data.that)[0]:$(P.data.that).find("img")[0],x=null,y&&"function"==typeof y.openDialog&&(z=y.openDialog()),setTimeout(()=>{g()},300)}):void 0}})}),window.AVIARY_API_KEY&&J.push(function(N){v.append(()=>{if($(N).css("background-image")&&""!=$(N).css("background-image")&&!$(".yeti-context-menu-button.edit-background-image").length){var O=$(N).css("background-image");O=/^url\((['"]?)(.*)\1\)$/.exec(O);var P=O?O[2]:"";return P?$("<a class=\"yeti-context-menu-button edit-background-image\"><i class=\"ion-images\"></i>Edit Image<img src=\""+P+"\"></a>").on("mousedown",{that:N,imageSrc:P},Q=>{$("#bgImageContainer").attr("src",Q.data.imageSrc),E=$("#bgImageContainer")[0],x=$(Q.data.that),csdkImageEditor.launch({image:E.id,url:E.src}),d(),setTimeout(()=>{w.hide(),g()},300),g()}):void 0}})}),window.UPLOADCARE_PUBLIC_KEY&&J.push(function(N){v.append(()=>{if($(N).css("background-image")&&""!=$(N).css("background-image")&&!$(".yeti-context-menu-button.replace-background-image").length){var O=$(N).css("background-image");O=/^url\((['"]?)(.*)\1\)$/.exec(O);var P=O?O[2]:"";return P?$("<a class=\"yeti-context-menu-button replace-background-image\"><i class=\"ion-images\"></i>Replace<img src=\""+P+"\"></a>").on("mousedown",{that:N,imageSrc:P},Q=>{$("#bgImageContainer").attr("src",Q.data.imageSrc),E=$("#bgImageContainer")[0],x=$(Q.data.that),y&&"function"==typeof y.openDialog&&(z=y.openDialog()),setTimeout(g,300),g()}):void 0}})}),J.push(function(N){v.append(()=>{return $(".yeti-context-menu-button.clone-element").length?void 0:$("<a class=\"yeti-context-menu-button clone-element\"><i class=\"ion-ios-copy-outline\" style=\"padding-right:7px !important\"></i>Clone Element</a>").on("mousedown",{that:N},O=>{g(),$(O.data.that).parent().append($(O.data.that).clone()),h()})})}),J.push(function(N){v.append(()=>{return $(".yeti-context-menu-button.remove-button").length?void 0:$("<a class=\"yeti-context-menu-button remove-button\"><i class=\"ion-backspace\" style=\"padding-right:7px !important\"></i>Remove</a>").on("mousedown",{that:N},O=>{g(),$(O.data.that).remove(),h()})})}),J.push(function(N){v.append(()=>{return $(".yeti-context-menu-button.stop-editing").length&&$(".yeti-context-menu-button.stop-editing").remove(),$("<a class=\"yeti-context-menu-button stop-editing\"><i class=\"ion-stop\" style=\"padding-right:7px !important\"></i>Stop Editing</a>").on("mousedown",{that:N},()=>{g(),p()})})}),$(document).ready(()=>{t=$("head"),u=$("body"),u.append("<div class=\"yeti cleanslate\"><div class=\"yeti-context-menu main\"></div></div><div class=\"yeti cleanslate\"><div class=\"yeti-context-menu secondary\"><a class=\"yeti-context-menu-button yeti-quarter-button\"><span class=\"lnr lnr-bold\"></span></a><a class=\"yeti-context-menu-button yeti-quarter-button\"><span class=\"lnr lnr-italic\"></span></a><a class=\"yeti-context-menu-button yeti-quarter-button\"><span class=\"lnr lnr-underline\"></span></a><a class=\"yeti-context-menu-button yeti-quarter-button\"><span class=\"lnr lnr-strikethrough\"></span></a></div></div>"),G||f(),$&&$.event&&$.event.special&&"object"==typeof $.event.special&&($.event.special.tripleclick={setup:function(){jQuery(this).bind("click",jQuery.event.special.tripleclick.handler)},teardown:function(){jQuery(this).unbind("click",jQuery.event.special.tripleclick.handler)},handler:function(N){var O=jQuery(this).data("clicks")||0;O+=1,3===O&&(O=0,N.type="tripleclick",jQuery.event.handle===void 0?jQuery.event.dispatch.apply(this,arguments):jQuery.event.handle.apply(this,arguments)),setTimeout(()=>{jQuery(this).data("clicks",0)},700),jQuery(this).data("clicks",O)}}),$(document).on("tripleclick",o),$(document).on("keydown",N=>{C&&90==N.keyCode&&(N.metaKey||N.ctrlKey)&&(N.preventDefault(),N.shiftKey?l():j());69===N.keyCode&&N.shiftKey&&(N.metaKey||N.ctrlKey)&&(C?p():o())}),F=setInterval(()=>{if(A&&window.incomingEditorChanges&&incomingEditorChanges.length){for(;incomingEditorChanges&&incomingEditorChanges.length;){var N=incomingEditorChanges.shift();try{A.apply(document.body,N.diff)}catch(O){}K.push(N)}u.addClass("ggLoaded"),clearInterval(F),g()}},500),setTimeout(()=>{u.addClass("ggLoaded")},1800),g()}),window.WYSIWYG={domUserModified:h,editorModules:J,future(){return L},past(){return K},saveDOM:g,disable:p,enable:o,undo:j,redo:l}})();